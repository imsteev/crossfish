<!DOCTYPE html>
<html>
  <script>
    const spawnedFishColors = {};
    try {
      const ev = new EventSource("http://localhost:8080/server/events");
      ev.onmessage = function ({ data }) {
        if (!spawnedFishColors[data]) {
          spawnedFishColors[data] = randomHexColor();
        }
        const spawnedFishRoot = document.getElementById("spawned-fish");
        if (spawnedFishRoot) {
          spawnedFishRoot.appendChild(
            Fish({ name: data, color: spawnedFishColors[data] })
          );
        }
      };
    } catch (e) {
      console.log(e);
    }

    function Fish({ name, color }) {
      const div = document.createElement("div");
      div.style = `padding: 16px; margin: 16px; border: solid 1px grey;align-items:flex-start; flex-shrink: 0.3;background: #${color};`;
      div.innerHTML = `${name} (${Date.now().toString()})`;
      return div;
    }

    function randomHexColor() {
      return Math.floor(Math.random() * 16777215).toString(16);
    }
  </script>
  <style>
    #spawned-fish {
      display: flex;
      flex-wrap: wrap;
      flex-direction: row;
      justify-content: flex-start;
    }
    #spawned-fish > div:nth-last-child(1) {
      background: forestgreen;
    }
    #spawned-fish > div:nth-last-child(2) {
      background: lightsalmon;
    }
  </style>
  <body>
    <div id="spawned-fish"></div>
  </body>
</html>
